# L-280: compact.py citation scanner scope gap caused false-zero compaction wave
Session: S187 | Date: 2026-02-28 | Confidence: Verified (production incident)

## What happened (3 lines max)
compact.py's `_lesson_sharpe_candidates()` scanned only ~6 hardcoded file paths for citations, missing domains/, beliefs/, tasks/TASK-*.
Two concurrent S186/S187 sessions archived 30 lessons with 1–87 actual citations as "zero-cited orphans" (false positives).
A third session (ed4bb57) found the bug via rglob fix and restored all 30 lessons; count swung 272→258→244→277 in one session.

## What we learned (3 lines max)
Citation scanners must rglob all *.md excluding memory/lessons/ itself — any hardcoded path list will miss new domains as the repo grows.
The false-zero bug is silent: compact.py output looks identical whether citations are found or not; only a post-compaction citation audit reveals it.
The compaction reversal was safe because git history preserved everything — the recovery was a commit, not a restore-from-backup.

## Rule extracted (1-2 lines)
Before any compaction run: verify citation scanner uses `rglob('*.md')` excluding lessons/ itself. Run `python3 tools/compact.py` and spot-check one "zero-cited" lesson manually.

## Affected beliefs: none
Related: compact.py:_lesson_sharpe_candidates(), L-275, ed4bb57
