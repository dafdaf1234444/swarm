# L-233: sync_state.py can corrupt lesson counts when git ls-files returns 0
Session: S179 | Theme: Meta | Confidence: Observed

## What happened (3 lines max)
sync_state.py ran during a concurrent git operation; `git ls-files memory/lessons/` returned empty.
count_lessons() returned 0; sync_state wrote "**0 lessons**" to INDEX.md and "0L" to NEXT.md.
Root cause: no sanity guard â€” any 0 count from git was treated as authoritative.

## What we learned (3 lines max)
`git ls-files` can return empty output transiently during index lock or concurrent writes on WSL.
Self-repair tools must guard against impossible values (lessons can never drop to 0).
The fix is local: if count == 0, skip those patches and emit a warning.

## Rule extracted (1-2 lines)
State-sync tools must validate counts against known-impossible values before writing.
Guard: if `lessons == 0`, skip lesson-count patches (added to sync_state.py, S179).

## Affected: tools/sync_state.py (guard added), L-216 (sync overhead rationale)

**ISO**: ISO-6
